<app-universal-search [appButtons]="buttons" (actionTriggered)="handleUniversalSearchAction($event)" />

<div class="container">
  <!-- Title Section with Floating Background -->
  <div class="title-card">
    <h1 class="title">MIS Technical Team</h1>
    <!-- Work Timer (7:30 -> 16:30) -->
    <div class="work-timer" [attr.data-state]="timerState()">
      <div class="timer-label">{{ timerLabel() }}</div>
      <div class="timer-value">{{ timerValue() }}</div>
    </div>
  </div>

  <!-- Logo (top-left) -->
  <div class="global-logo" title="Sohid Usman">
    <img src="/SohidUsman.jpg" alt="Sohid Usman" />
  </div>

  <!-- Digital Clock (top-right) -->
  <div id="clock" class="light">
    <div class="display">
      <div class="weekdays">
        @for (day of ['SAT', 'SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI']; track $index) {
          <span [class.active]="clockWeekday() === $index">{{ day }}</span>
        }
      </div>
      <div class="ampm">{{ clockAmPm() }}</div>
      <div class="digits">
        <div [class]="clockHours()[0]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
        <div [class]="clockHours()[1]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
        <div class="dots"></div>
        <div [class]="clockMinutes()[0]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
        <div [class]="clockMinutes()[1]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
        <div class="dots"></div>
        <div [class]="clockSeconds()[0]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
        <div [class]="clockSeconds()[1]">
          <span class="d1"></span>
          <span class="d2"></span>
          <span class="d3"></span>
          <span class="d4"></span>
          <span class="d5"></span>
          <span class="d6"></span>
          <span class="d7"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Buttons Row (single-line) -->
  <div class="buttons-row">

    @for (button of buttons; track button.id) {
      <button 
        class="btn" 
        (click)="onTopButtonClick($event, button.id)"
        [routerLink]="getButtonRoute(button.id)"
        routerLinkActive="btn-active"
        [attr.data-id]="button.id">
        {{ button.name }}
      </button>
    }
  </div>

  <!-- Router Outlet for Components -->
  <div class="content-area">
    <router-outlet></router-outlet>
  </div>

  <!-- Unlock Results Modal -->
  @if (unlockDialogVisible()) {
  <div class="modal-overlay" (click)="closeUnlockDialog()">
    <div class="modal" (click)="$any($event).stopPropagation()">
      <button class="modal-close" (click)="closeUnlockDialog()">âœ•</button>

      <h1>Unlock AD Accounts</h1>

      @if (isUnlocking()) {
      <div class="modal-body">
        <div class="loading">Unlocking accounts...</div>
      </div>
      } @else {
      <div class="modal-body">
        <div class="results">
          <div class="result-col">
            <h2>Unlocked ({{ unlocked().length }})</h2>
            <ul>
              @for (u of unlocked(); track $index) {
              <li>{{ u }}</li>
              }
            </ul>
          </div>

          <div class="result-col">
            <h2>Failed ({{ failed().length }})</h2>
            <ul>
              @for (f of failed(); track $index) {
              <li><strong>{{ f.samAccountName }}</strong>: {{ f.reason }}</li>
              }
            </ul>
          </div>
        </div>
      </div>
      }

      <div class="modal-actions">
        <button class="btn" (click)="closeUnlockDialog()">Close</button>
      </div>
    </div>
  </div>
  }
  <!-- Toast Notifications -->
  <app-toast></app-toast>

  <!-- Universal Search Modal -->
  <app-universal-search></app-universal-search>
</div>