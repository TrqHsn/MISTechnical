<div class="form-container">
  <div class="form-header">
    <h1>New User Assignment Form</h1>
  </div>

  <form [formGroup]="form" class="assign-form">
    <div class="form-grid">
      <!-- First Name -->
      <div class="form-group">
        <label for="firstName">First Name <span class="required">*</span></label>
        <input
          type="text"
          id="firstName"
          class="form-input"
          formControlName="firstName"
          placeholder="Enter first name"
        />
        @if (form.get('firstName')?.invalid && form.get('firstName')?.touched) {
          <div class="error">
            First name is required
          </div>
        }
      </div>

      <!-- Last Name -->
      <div class="form-group">
        <label for="lastName">Last Name <span class="required">*</span></label>
        <input
          type="text"
          id="lastName"
          class="form-input"
          formControlName="lastName"
          placeholder="Enter last name"
        />
        @if (form.get('lastName')?.invalid && form.get('lastName')?.touched) {
          <div class="error">
            Last name is required
          </div>
        }
      </div>

      <!-- Section -->
      <div class="form-group">
        <label for="section">Section <span class="required">*</span></label>
        <input
          type="text"
          id="section"
          class="form-input"
          formControlName="section"
          placeholder="Enter section"
        />
        @if (form.get('section')?.invalid && form.get('section')?.touched) {
          <div class="error">
            Section is required
          </div>
        }
      </div>

      <!-- Department -->
      <div class="form-group">
        <label for="department">Department <span class="required">*</span></label>
        <input
          type="text"
          id="department"
          class="form-input"
          formControlName="department"
          placeholder="Enter department"
        />
        @if (form.get('department')?.invalid && form.get('department')?.touched) {
          <div class="error">
            Department is required
          </div>
        }
      </div>
    </div>

    <!-- Items Loaned Table -->
    <div class="items-table">
      <h3>Items Loaned</h3>
      <table>
        <thead>
          <tr>
            <th>Item Loaned</th>
            <th>Provided?</th>
            <th>Condition</th>
          </tr>
        </thead>
        <tbody>
          @for (item of items; track item.name; let i = $index) {
            <tr>
              <td>{{ item.name }}</td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [formControlName]="'provided' + (i + 1)"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [formControlName]="'condition' + (i + 1)"
                  />
                  <span class="toggle-slider"></span>
                  <span class="toggle-label">
                    {{ form.get('condition' + (i + 1))?.value ? 'New' : 'Used' }}
                  </span>
                </label>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    <!-- Status Message -->
    @if (message) {
      <div class="message">
        {{ message }}
      </div>
    }

    <!-- Action Buttons -->
    <div class="form-actions">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="clearForm()"
        [disabled]="isProcessing"
      >
        Clear
      </button>
      <button
        type="button"
        class="btn btn-primary"
        (click)="generateDocx()"
        [disabled]="form.invalid || isProcessing"
      >
        ðŸ“„ Generate DOCX
      </button>
      <button
        type="button"
        class="btn btn-success"
        (click)="silentPrint()"
        [disabled]="form.invalid || isProcessing"
      >
        âš¡ Silent Print
      </button>
    </div>
  </form>
</div>
